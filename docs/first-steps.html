<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>Getting started</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
<h1>Getting started</h1>
</div>
<div id="content">
<div class="sect1">
<h2 id="_picross">PiCross</h2>
<div class="sectionbody">
<div class="paragraph">
<p>PiCross puzzles are also known as <em>nonograms</em>.
First, you should familiarize yourself with the game: read the <a href="https://en.wikipedia.org/wiki/Nonogram">rules</a>
and solve some puzzles online:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.nonograms.org/" class="bare">https://www.nonograms.org/</a></p>
</li>
<li>
<p><a href="https://www.puzzle-nonograms.com/" class="bare">https://www.puzzle-nonograms.com/</a></p>
</li>
<li>
<p><a href="https://www.hanjie-star.com/" class="bare">https://www.hanjie-star.com/</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s introduce some terminology:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The central part of the puzzle is called the <strong>grid</strong>.</p>
</li>
<li>
<p>The grid is made out of <strong>squares</strong>.</p>
</li>
<li>
<p>The numbers on the sides of the grid are called the <strong>constraints</strong>.</p>
<div class="ulist">
<ul>
<li>
<p>The numbers on the left are the <strong>row constraints</strong>.</p>
</li>
<li>
<p>The numbers on the top are the <strong>column constraints</strong>.</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_puzzle_class"><code>Puzzle</code> Class</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The first thing we&#8217;ll want to implement is a working playable puzzle, i.e., focus on creating a GUI that allows people to play a puzzle and ignore all the other functionality the domain offers.</p>
</div>
<div class="paragraph">
<p>First, we need a puzzle to solve.
A puzzle is modeled by the <code>Puzzle</code> class.
A <code>Puzzle</code> object contains all information about a puzzle.
The most important members are</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <code>Grid</code> property: this grid contains the actual solution of the puzzle. It has type
<code>IGrid&lt;bool&gt;</code>, where <code>true</code> values represent filled squares and <code>false</code> empty squares.</p>
</li>
<li>
<p>the properties <code>RowConstraints</code> and <code>ColumnConstraints</code> represent the constraints of the puzzle.
The type of both of these properties is <code>ISequence&lt;Constraints&gt;</code>. <code>ISequence&lt;T&gt;</code> is quite similar to
arrays/lists, but with some added functionality, which we won&#8217;t get into right now.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A <code>Puzzle</code> object is <strong>immutable</strong>, which means that once created, it can never be changed.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_a_puzzle_object">Creating a <code>Puzzle</code> Object</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>Puzzle</code> class sports multiple static factory methods which you can use to create a puzzle,
either from constraints using <code>Puzzle.FromConstraints</code> or from the solution using <code>Puzzle.FromRowStrings</code>.
For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="csharp"><span class="kt">var</span> <span class="n">puzzle</span> <span class="p">=</span> <span class="n">Puzzle</span><span class="p">.</span><span class="nf">FromRowStrings</span><span class="p">(</span>
    <span class="s">"xxxxx"</span><span class="p">,</span>
    <span class="s">"x...x"</span><span class="p">,</span>
    <span class="s">"x...x"</span><span class="p">,</span>
    <span class="s">"x...x"</span><span class="p">,</span>
    <span class="s">"xxxxx"</span>
<span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>creates a puzzle whose solution is a 5&times;5 square.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_a_playable_puzzle">Creating a Playable Puzzle</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>Puzzle</code> class does not provide any functionality to <em>solve</em> a puzzle.
Instead, it just contains the data describing the puzzle.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A <code>Puzzle</code> is immutable. It would be a rather absurd game if the player
is not able to do anything.</p>
</li>
<li>
<p>A <code>Puzzle</code>'s Grid contains <code>bool</code>s: either a square is filled, or it is empty.
To solve a puzzle, we also want an "as of yet unknown" value.
When starting to solve a puzzle, the entire grid should be filled with this <code>unknown</code> value, and the player then completes the puzzle by gradually marking certain squares as empty or filled.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The domain offers a separate class called <code>PlayablePuzzle</code>.
<code>PlayablePuzzle</code> objects offer a <em>modifiable</em> grid of type <code>IGrid&lt;IPlayablePuzzleSquare&gt;</code>.
Each square in this grid can contain one of <strong>three</strong> possible values: <code>Square.UNKNOWN</code>, <code>Square.FILLED</code> or <code>Square.EMPTY</code>.</p>
</div>
<div class="paragraph">
<p>We encourage you to take a look through the domain code and find this <code>PlayablePuzzle</code> class.
However, you&#8217;ll find that it is declared <code>internal</code>, i.e., it is private to the domain.
What now?</p>
</div>
<div class="paragraph">
<p>We endeavored to minimize the number of domain classes you can instantiate directly.
The reason is that once we allow you to create a <code>PlayablePuzzle</code> directly, this takes a lot of freedom away from us domain authors: the <code>PlayablePuzzle</code> class cannot be renamed without breaking your code, we cannot redesign it, etc.
But, admittedly, making it <code>internal</code> makes it rather useless, as you cannot access it at all.</p>
</div>
<div class="paragraph">
<p>A solution to this problem consists relying on interfaces.
The interface makes certain guarantees about what functionality we will provide, so that at least you can actually intereact with it.
On our side (the implementers of the domain code), we can do all kinds of crazy stuff: we can have this interface implemented by any class we want, we can spread it out over multiple classes, etc.
So, using interfaces gives you functionality and gives us freedom of design.
It&#8217;s a win win situation.</p>
</div>
<div class="paragraph">
<p>Well, almost.
Interfaces have a limitation: they cannot be instantiated.
To remedy this, we introduce factory methods, available in the <code>PiCrossFacade</code> class:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="csharp"><span class="kt">var</span> <span class="n">puzzle</span> <span class="p">=</span> <span class="n">Puzzle</span><span class="p">.</span><span class="nf">FromRowStrings</span><span class="p">(</span>
    <span class="s">"xxxxx"</span><span class="p">,</span>
    <span class="s">"x...x"</span><span class="p">,</span>
    <span class="s">"x...x"</span><span class="p">,</span>
    <span class="s">"x...x"</span><span class="p">,</span>
    <span class="s">"xxxxx"</span>
<span class="p">);</span>
<span class="kt">var</span> <span class="n">facade</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PiCrossFacade</span><span class="p">();</span>
<span class="kt">var</span> <span class="n">playablePuzzle</span> <span class="p">=</span> <span class="n">facade</span><span class="p">.</span><span class="nf">CreatePlayablePuzzle</span><span class="p">(</span><span class="n">puzzle</span><span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, <code>CreatePlayablePuzzle</code> wraps <code>puzzle</code> inside a <code>IPlayablePuzzle</code> object.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_a_playable_puzzle">Using a Playable Puzzle</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Let&#8217;s take a look at this <code>IPlayablePuzzle</code> interface.
It contains only a few members:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>Grid</code> represents the current state of the grid.
This is what the player interacts with: (s)he&#8217;s supposed to be able to change an arbitrary square of the grid to filled, empty (or back to unknown.)</p>
</li>
<li>
<p><code>ColumnConstraints</code> and <code>RowConstraints</code> represent the constraints.</p>
</li>
<li>
<p><code>IsSolved</code> is a <code>Cell&lt;bool&gt;</code>.
If <code>true</code>, it means the grid, in its current state, contains the correct solution, i.e. the puzzle is solved.
<code>false</code> means the opposite.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <code>Grid</code> and both <code>Constraints</code> properties are actually upgraded version of their <code>Puzzle</code> counterparts: they all rely heavily on <code>Cell`s, which makes it easy for you to bind your GUI controls to them.
They also offer extra information such as `IsSatisfied</code> in <code>IPlayablePuzzleConstraints</code> and <code>IPlayablePuzzleConstraintsValue</code>.
You should take a quick peek at <code>IPlayablePuzzle</code> and the related interfaces to get an idea of what functionality they offer.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_visualizing_a_playable_puzzle">Visualizing a Playable Puzzle</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If there&#8217;s anything you need to learn about software development, it&#8217;s this: baby steps.
We&#8217;re serious.
Don&#8217;t try to create the entire GUI in one go, because if it doesn&#8217;t work, you won&#8217;t know where to look for mistakes.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s start with visualizing the puzzle.
This is probably the most complicated part of developing PiCross, and unfortunately, we have
little choice but to start with it.
To alleviate your pain, we have written a <code>PiCrossControl</code> for you.</p>
</div>
<div class="sect2">
<h3 id="_step_1_red_rectangles">Step 1: Red Rectangles</h3>
<div class="paragraph">
<p>To learn to work with it, careful experimentation is key.
Let&#8217;s start with adding a <code>PiCrossControl</code> to our <code>MainWindow</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="diff">  &lt;Window x:Class="View.MainWindow"
          xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
          xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
          xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
          xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
<span class="gi">+         xmlns:controls="clr-namespace:View.Controls"
</span>          mc:Ignorable="d"
          Title="MainWindow" Height="350" Width="525"&gt;
      &lt;Grid&gt;
<span class="gi">+         &lt;controls:PiCrossControl&gt;
+         &lt;/controls:PiCrossControl&gt;
</span>      &lt;/Grid&gt;
  &lt;/Window&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>PiCrossControl</code> cannot magically know what to show.
We need to give it some data.
In WPF, this is generally done using <em>dependency properties</em>, so let&#8217;s explore which such properties <code>PiCrossControl</code> has to offer.
For this, you can either take a look at its source code or use the XAML Designer help you.</p>
</div>
<div class="paragraph">
<p>The <code>Grid</code> property allows you to tell <code>PiCrossControl</code> which grid to draw.
The property&#8217;s type is <code>IGrid&lt;object&gt;</code>, which means you can pass along any object you wish.
This raises the question: how can <code>PiCrossControl</code> know how to draw that object?</p>
</div>
<div class="paragraph">
<p><code>SquareTemplate</code> seems like an interesting property: it tells <code>PiCrossControl</code> how to draw each square in the <code>Grid</code>.
It looks as if we&#8217;re now ready to get something to appear on our screens.</p>
</div>
<div class="paragraph">
<p>First, we need a <code>IGrid&lt;object&gt;</code>. We can make one using <code>Grid.Create</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="diff">  // Using declarations
<span class="gi">+ using Grid = DataStructures.Grid; <b class="conum">(1)</b>
+ using Size = DataStructures.Size; <b class="conum">(2)</b>
</span>
  namespace View
  {
      /// &lt;summary&gt;
      /// Interaction logic for MainWindow.xaml
      /// &lt;/summary&gt;
      public partial class MainWindow : Window
      {
          public MainWindow()
          {
              InitializeComponent();
<span class="gi">+
+             var grid = Grid.Create&lt;string&gt;( new Size( 5, 5 ), p =&gt; "x" ); <b class="conum">(3)</b>
</span>          }
      }
  }</code></pre>
</div>
</div>
<div class="colist arabic">
<ol>
<li>
<p>Both WPF and our code define <code>Grid</code> and <code>Size</code>.
If we were to simply use <code>Grid</code> and <code>Size</code> in our code, the compiler would not know which one we meant.
The <code>using</code> declarations at the top of the file resolve this ambiguity: it effectly tells the compiler that whenever you write <code>Grid</code>, you mean <code>DataStructures.Grid</code>.</p>
</li>
<li>
<p>Idem for <code>Size</code>.</p>
</li>
<li>
<p>The line added to <code>MainWindow&#8217;s constructor creates a 5&times;5 grid filled with `"x"</code>.
Understanding the second parameter is not important, but for those interested: it&#8217;s an anonymous function
that given a parameter <code>p</code> (of type <code>Vector2D</code>, which is inferred by the compiler) returns <code>"x"</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>So, now we&#8217;ve got a 5&times;5 grid filled with <code>"x"`es. It&#8217;s a good enough start.
We&#8217;ll fill it with more interesting values later on.
Let&#8217;s focus now on finding a way to pass this grid along to our `PiCrossControl</code>.
The easiest way to achieve this is to give the control a name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="diff">  &lt;Grid&gt;
<span class="gd">-     &lt;controls:PiCrossControl&gt;
</span><span class="gi">+     &lt;controls:PiCrossControl x:Name="picrossControl"&gt;
</span>      &lt;/controls:PiCrossControl&gt;
  &lt;/Grid&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>and to programmatically set its <code>Grid</code> property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="diff">    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();

            var grid = Grid.Create&lt;string&gt;( new Size( 5, 5 ), p =&gt; "x" );
<span class="gi">+           picrossControl.Grid = grid;
</span>        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Next, let&#8217;s define a <code>SquareTemplate</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="diff">  &lt;Grid&gt;
      &lt;controls:PiCrossControl&gt;
<span class="gi">+         &lt;controls:PiCrossControl.SquareTemplate&gt;
+             &lt;DataTemplate&gt;
+                 &lt;Rectangle Width="32" Height="32" Fill="Red" Stroke="Black" /&gt;
+             &lt;/DataTemplate&gt;
+         &lt;/controls:PiCrossControl.SquareTemplate&gt;
</span>      &lt;/controls:PiCrossControl&gt;
  &lt;/Grid&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Running your project should make a window appear with 5&times;5 red rectangles. Make sure
you understand why there are 25 such rectangles. Feel free to experiment a bit (e.g. change the rectangle&#8217;s color
or grid&#8217;s size) to verify your assumptions.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_2_datacontexts">Step 2: DataContexts</h3>
<div class="paragraph">
<p>Every square is now drawn the same, i.e., as a red rectangle. For our game to be playable,
each square has to be able to adapt its looks depending on the state of the game. In the case of PiCross,
squares can have one of three states: empty, filled or unknown. The <code>SquareTemplate</code> needs
to be able to access that information and draw itself accordingly.</p>
</div>
<div class="paragraph">
<p>As with other WPF-controls relying on templates, we will rely on <code>DataContext`s to pass along information.
The `PiCrossControl</code> was given a <code>Grid</code> which right now contains nothing but <code>"x"`s. For each element
of the `Grid</code>, the <code>PiCrossControl</code> instantiates the <code>SquareTemplate</code> and sets its <code>DataContext</code> to
the corresponding element. Using bindings we can access the data stored in this <code>DataContext</code>.</p>
</div>
<div class="paragraph">
<p>Right now, we ignore the <code>"x"</code> value completely. Let&#8217;s make it appear.
Instead of a <code>Rectangle</code>, we&#8217;ll use a <code>TextBlock</code> whose <code>Text</code> property
is bound to the `Grid&#8217;s corresponding value.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="diff">    &lt;controls:PiCrossControl x:Name="picrossControl"&gt;
        &lt;controls:PiCrossControl.SquareTemplate&gt;
            &lt;DataTemplate&gt;
<span class="gd">-               &lt;Rectangle Width="32" Height="32" Fill="Red" Stroke="Black" /&gt;
</span><span class="gi">+               &lt;TextBlock Width="32" Height="32" Background="Red" Text="{Binding}" /&gt;
</span>            &lt;/DataTemplate&gt;
        &lt;/controls:PiCrossControl.SquareTemplate&gt;
    &lt;/controls:PiCrossControl&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>{Binding}</code> means "take the value of the <code>DataContext</code> itself." Since
the <code>DataContext</code> always equals <code>"x"</code>, regardless of which square is being processed,
each <code>TextBlock&#8217;s `Text</code> property should be set to <code>"x"</code>. You can verify this by launching
the application: a 5&times;5 grid of `x&#8217;s should appear.</p>
</div>
<div class="paragraph">
<p>If this works, we know we have successfully accessed the <code>DataContext</code>. We can now
take the next step: make the <code>DataContext</code> different for each square.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_3_coordinates">Step 3: Coordinates</h3>
<div class="paragraph">
<p>We created our grid as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="c#"><span class="kt">var</span> <span class="n">grid</span> <span class="p">=</span> <span class="n">Grid</span><span class="p">.</span><span class="n">Create</span><span class="p">&lt;</span><span class="kt">string</span><span class="p">&gt;(</span> <span class="k">new</span> <span class="nf">Size</span><span class="p">(</span> <span class="m">5</span><span class="p">,</span> <span class="m">5</span> <span class="p">),</span> <span class="n">p</span> <span class="p">=&gt;</span> <span class="s">"x"</span> <span class="p">);</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Instead of having each grid square be equal to <code>"x"</code>, let&#8217;s have
it show the square&#8217;s coordinates:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="diff">    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();

-           var grid = Grid.Create&lt;string&gt;( new Size( 5, 5 ), p =&gt; "x" );
<span class="gi">+           var grid = Grid.Create&lt;string&gt;( new Size( 5, 5 ), p =&gt; p.ToString() );
</span>            picrossControl.Grid = grid;
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run the application to verify that the `x`s have indeed been replaced by coordinates.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_4_text_squares">Step 4: Text Squares</h3>
<div class="paragraph">
<p>Let&#8217;s now switch to showing an actual puzzle.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="diff">    public partial class MainWindow : Window
    {
        public MainWindow()
        {
            InitializeComponent();

-           var grid = Grid.Create&lt;string&gt;( new Size( 5, 5 ), p =&gt; p.ToString() );
<span class="gd">-           picrossControl.Grid = grid;
</span>
+           var puzzle = Puzzle.FromRowStrings(
<span class="gi">+               "xxxxx",
+               "x...x",
+               "x...x",
+               "x...x",
+               "xxxxx"
+           );
+           var facade = new PiCrossFacade();
+           var playablePuzzle = facade.CreatePlayablePuzzle( puzzle );
</span>
+           picrossControl.Grid = playablePuzzle.Grid;
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s run this to see what happens. You should see a 5&times;5 grid whose
squares contain some string starting with <code>PiCross</code>. The fact that there are 5&times;5
squares is a good sign. But where does that string come from?</p>
</div>
<div class="paragraph">
<p><code>playablePuzzle.Grid</code> returns a grid, but what is its type?
Hovering over it makes a tooltip appear telling us
its type is <code>IGrid&lt;IPlayablePuzzleSquare&gt;</code>. <code>IPlayablePuzzleSquare</code>
is an interface; we&#8217;d prefer to know what the actual class is.
In order to find out, add a breakpoint on <code>MainWindow.MainWindow&#8217;s last line.
Start the application in debug mode (F5). Hovering over `playablePuzzle.Grid</code>
should give you more detailed information: it&#8217;s actually
a <code>PiCross.PlayablePuzzle.PlayablePuzzleSquare</code>!
This is probably what is being printed inside each square.
Let&#8217;s check if we are correct about this.</p>
</div>
<div class="paragraph">
<p>Go dig into the domain and look for the <code>PlayablePuzzle</code> class. Within
it there should be a nested class <code>PlayablePuzzleSquare</code>. Extend it with a
<code>ToString()</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="diff">    private class PlayablePuzzleSquare : IPlayablePuzzleSquare
    {
        public PlayablePuzzleSquare( PlayablePuzzle parent, IVar&lt;Square&gt; contents, Vector2D position )
        {
            this.Contents = new PlayablePuzzleSquareContentsCell( parent, contents, position );
            this.Position = position;
        }

        Cell&lt;Square&gt; IPlayablePuzzleSquare.Contents =&gt; Contents;

        public PlayablePuzzleSquareContentsCell Contents { get; }

        public Vector2D Position { get; }

+       public override string ToString()
<span class="gi">+       {
+           return "test!";
+       }
</span>    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Launch the application. Each square should now say <code>test!</code>.</p>
</div>
<div class="paragraph">
<p>During software development, it is important for you to fully comprehend what is happening.
Try to check your assumptions at each step, otherwise you might start building
things on shaky ground and sooner or later everything will collapse.
Don&#8217;t let things "stay magical": the better students are those who are
willing to spend a couple of extra seconds getting a good grasp on what they are working with.</p>
</div>
<div class="paragraph">
<p>You can now remove the <code>ToString()</code> method, it serves little purpose.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s see what a <code>IPlayablePuzzleSquare</code> has to offer. Go to this interface&#8217;s definition
in the domain code. You&#8217;ll see it exposes two properties: <code>Contents</code> and <code>Position</code>.
The former sounds particularly interesting.</p>
</div>
<div class="paragraph">
<p><code>Contents</code> is a <code>Cell&lt;Square&gt;</code>. <code>Cell</code> should sound familiar, so let&#8217;s skip that
and go straight to <code>Square</code>. Read its documentation. Just like a <code>bool</code>
can only take on two different values (<code>true</code> and <code>false</code>), there are only three <code>Square</code> values:
<code>UNKNOWN</code>, <code>EMPTY</code> and <code>FILLED</code>. These are defined as static fields. This is particularly
interesting to us: depending on the square value, we can choose which color
to use to draw it with.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s go back to our XAML. Let&#8217;s say we want filled squares to be black,
empty squares to be white and unknown squares to be gray. But as always, small steps,
so let&#8217;s first try to access the square information.</p>
</div>
<div class="paragraph">
<p>Right now, our squares' look is determined by the following line of XAML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="xml"><span class="nt">&lt;TextBlock</span> <span class="na">Width=</span><span class="s">"32"</span> <span class="na">Height=</span><span class="s">"32"</span> <span class="na">Background=</span><span class="s">"Red"</span> <span class="na">Text=</span><span class="s">"{Binding}"</span> <span class="nt">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>We know that its <code>DataContext</code> is an <code>IPlayablePuzzleSquare</code>, which
has a property <code>Contents</code> of type <code>Cell.Square</code>. Let&#8217;s bind to that instead:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="diff">    &lt;controls:PiCrossControl x:Name="picrossControl"&gt;
        &lt;controls:PiCrossControl.SquareTemplate&gt;
            &lt;DataTemplate&gt;
<span class="gd">-               &lt;TextBlock Width="32" Height="32" Background="Red" Text="{Binding}" /&gt;
</span><span class="gi">+               &lt;TextBlock Width="32" Height="32" Background="Red" Text="{Binding Contents.Value}" /&gt;
</span>            &lt;/DataTemplate&gt;
        &lt;/controls:PiCrossControl.SquareTemplate&gt;
    &lt;/controls:PiCrossControl&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you run the application, a grid of question marks appears. This is probably
due to the fact that a newly created <code>PlayablePuzzle</code> fills the grid with
<code>Square.UNKNOWN</code> values. Let&#8217;s check this.</p>
</div>
<div class="paragraph">
<p>Go to <code>Square.cs</code> in the domain and look for question marks. You&#8217;ll find that
there&#8217;s a class <code>Unknown</code> whose <code>Symbol</code> property returns <code>'?'</code>.
This makes sense with our previous theory. Temporarily change it to something else, for example <code>@</code>.
If our assumption is correct, we should be greeted by a 25 <code>@`s.
After ensuring this is indeed the case, change it back to `?</code>.</p>
</div>
<div class="paragraph">
<p>Why does the <code>PiCrossControl</code> decide to show the object&#8217;s <code>Symbol</code>? Does <code>Symbol</code> have a special meaning?
Look for all references to <code>Symbol</code> and you&#8217;ll discover that there&#8217;s simply a
<code>Square.ToString()</code> method that returns the <code>Symbol</code> as a string. As you should know,
using <code>ToString()</code> is the default way to render objects.</p>
</div>
<div class="paragraph">
<p>We&#8217;d like to make the grid more interesting by changing some squares.
But earlier, we told you that `Grid`s are immutable, which would mean
changing a square should be impossible.</p>
</div>
<div class="paragraph">
<p>Fortunately, there&#8217;s a loophole: the <code>Grid</code> itself is indeed immutable,
but the <strong>elements</strong> of the <code>Grid</code> needn&#8217;t be. As mentioned earlier,
the <code>Grid</code> contains <code>IPlayablePuzzleSquare</code> objects, which
have a <code>Contents</code> property which has type <code>Cell&lt;Square&gt;</code>, and
a `Cell`s contents can be modified. That&#8217;s our loophole.</p>
</div>
<div class="paragraph">
<p>Be sure to understand the following nuances:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The grid&#8217;s immutability means you cannot add/remove columns or rows.</p>
</li>
<li>
<p>The grid&#8217;s immutability means that you cannot change which element a grid contains. In our case,
it contains <code>Cell`s and the grid cannot be made to refer to other `Cell</code> objects.</p>
</li>
<li>
<p>However, the contents of the <code>Cell</code> itself can be changed. The <code>Grid</code> cannot prevent that from happening. (This ain&#8217;t C++.)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This immutability is a good thing: the more everything stays the same,
the easier it is to built a GUI for it. Were you to have to deal with
resizable grids and changing cells, it would be much harder to keep
everything in working order. The `Cell`s are a necessity to implement
the game: without it, the player wouldn&#8217;t be able to interact with the puzzle in any way.</p>
</div>
<div class="paragraph">
<p>In <code>MainWindow.MainWindow</code>, add the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="diff">    public MainWindow()
    {
        InitializeComponent();

        var puzzle = Puzzle.FromRowStrings(
            "xxxxx",
            "x...x",
            "x...x",
            "x...x",
            "xxxxx"
        );
        var facade = new PiCrossFacade();
        var playablePuzzle = facade.CreatePlayablePuzzle( puzzle );

+       playablePuzzle.Grid[new Vector2D( 0, 0 )].Contents.Value = Square.FILLED;
<span class="gi">+       playablePuzzle.Grid[new Vector2D( 1, 0 )].Contents.Value = Square.EMPTY;
</span>
        picrossControl.Grid = playablePuzzle.Grid;
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Make sure you understand what these two lines do. Run your application to
see if it behaves as expected.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_5_color_squares">Step 5: Color Squares</h3>
<div class="paragraph">
<p>Right now, each square&#8217;s contents is shown as a string (<code>?</code>, <code>x</code> or <code>.</code>).
Let&#8217;s turn this into gray, black and white, respectively.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="diff"><span class="gd">&lt;Window x:Class="View.MainWindow"
</span>        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:View"
        xmlns:controls="clr-namespace:View.Controls"
        mc:Ignorable="d"
        Title="MainWindow" Height="350" Width="525"&gt;
<span class="gi">+   &lt;Window.Resources&gt;
+       &lt;local:SquareConverter x:Key="squareConverter" /&gt;
+   &lt;/Window.Resources&gt;
</span>    &lt;Grid&gt;
        &lt;controls:PiCrossControl x:Name="picrossControl"&gt;
            &lt;controls:PiCrossControl.SquareTemplate&gt;
                &lt;DataTemplate&gt;
<span class="gd">-                   &lt;TextBlock Width="32" Height="32" Background="Red" Text="{Binding Contents.Value}" /&gt;
</span><span class="gi">+                   &lt;Rectangle Width="32" Height="32" Stroke="Black" Fill="{Binding Contents.Value, Converter={StaticResource squareConverter}}" /&gt;
</span>                &lt;/DataTemplate&gt;
            &lt;/controls:PiCrossControl.SquareTemplate&gt;
        &lt;/controls:PiCrossControl&gt;
    &lt;/Grid&gt;
<span class="gd">&lt;/Window&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Add the following <code>IValueConverter</code> to your code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="diff"><span class="gi">+   public class SquareConverter : IValueConverter
+   {
+       public object Convert( object value, Type targetType, object parameter, CultureInfo culture )
+       {
+           var square = (Square) value;
++           if ( square == Square.EMPTY )
+           {
+               return Brushes.White;
+           }
+           else if ( square == Square.FILLED )
+           {
+               return Brushes.Black;
+           }
+           else
+           {
+               return Brushes.Gray;
+           }
+       }
+
+       public object ConvertBack( object value, Type targetType, object parameter, CultureInfo culture )
+       {
+           throw new NotImplementedException();
+       }
+   }</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Run your application to make sure it works correctly.</p>
</div>
<div class="paragraph">
<p>We can improve upon this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Our <code>SquareConverter</code> is not reusable: it hardcodes the different colors.</p>
</li>
<li>
<p>We&#8217;d prefer having all "artistic" choices to be made in the XAML.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Parameterize your <code>SquareConverter</code> as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="diff">    public class SquareConverter : IValueConverter
    {
<span class="gi">+       public object Filled { get; set; }
</span>
+       public object Empty { get; set; }

+       public object Unknown { get; set; }

        public object Convert( object value, Type targetType, object parameter, CultureInfo culture )
        {
            var square = (Square) value;

            if ( square == Square.EMPTY )
            {
<span class="gd">-               return Brushes.White;
</span><span class="gi">+               return Empty;
</span>            }
            else if ( square == Square.FILLED )
            {
<span class="gd">-               return Brushes.Black;
</span><span class="gi">+               return Filled;
</span>            }
            else
            {
<span class="gd">-               return Brushes.Gray;
</span><span class="gi">+               return Unknown;
</span>            }
        }

        public object ConvertBack( object value, Type targetType, object parameter, CultureInfo culture )
        {
            throw new NotImplementedException();
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the XAML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="diff">    &lt;Window x:Class="View.MainWindow"
            xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
            xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
            xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
            xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
            xmlns:local="clr-namespace:View"
            xmlns:controls="clr-namespace:View.Controls"
            mc:Ignorable="d"
            Title="MainWindow" Height="350" Width="525"&gt;
<span class="gd">-       &lt;Window.Resources&gt;
-           &lt;local:SquareConverter x:Key="squareConverter" /&gt;
-       &lt;/Window.Resources&gt;
</span>        &lt;Grid&gt;
            &lt;controls:PiCrossControl x:Name="picrossControl"&gt;
                &lt;controls:PiCrossControl.SquareTemplate&gt;
                    &lt;DataTemplate&gt;
<span class="gd">-                       &lt;Rectangle Width="32" Height="32" Stroke="Black" Fill="{Binding Contents.Value, Converter={StaticResource squareConverter}}" /&gt;
</span><span class="gi">+                       &lt;Rectangle Width="32" Height="32" Stroke="Black"&gt;
+                           &lt;Rectangle.Fill&gt;
+                               &lt;Binding Path="Contents.Value"&gt;
+                                   &lt;Binding.Converter&gt;
+                                       &lt;local:SquareConverter Empty="White" Filled="Black" Unknown="Gray" /&gt;
+                                   &lt;/Binding.Converter&gt;
+                               &lt;/Binding&gt;
+                           &lt;/Rectangle.Fill&gt;
+                       &lt;/Rectangle&gt;
</span>                    &lt;/DataTemplate&gt;
                &lt;/controls:PiCrossControl.SquareTemplate&gt;
            &lt;/controls:PiCrossControl&gt;
        &lt;/Grid&gt;
    &lt;/Window&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Take a good look at this new XAML code:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>We define the <code>Rectangle&#8217;s `Fill</code> property using the property element syntax (<code>&lt;Rectangle.Fill&gt;&#8230;&#8203;&lt;/Rectangle.Fill</code>) instead of the attribute syntax (<code>Fill="&#8230;&#8203;"</code>). We trade in readability for flexibility: we are now free to assign any object we want to <code>Fill</code>.</p>
</li>
<li>
<p>We create a <code>Binding</code> object that binds to <code>Contents.Value</code>, same as before.</p>
</li>
<li>
<p>We specify the converter using property element syntax (no more using a static resource.)</p>
</li>
<li>
<p>We parameterize the <code>SquareConverter</code> from within the XAML code: <code>Empty="White" Filled="Black" Unknown="Gray"</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Run the application to check if everything still works.</p>
</div>
</div>
<div class="sect2">
<h3 id="_step_6_constraints">Step 6: Constraints</h3>
<div class="paragraph">
<p>Without constraints, the player cannot be expected to solve the puzzle.
Fortunately for <sub>~us</sub>~ you, <code>PiCrossControl</code> also provides
the necessary logic to show constraints.</p>
</div>
<div class="paragraph">
<p>Take a look at `PiCrossControl&#8217;s code: you&#8217;ll find the following
properties that will seem pertinent to the task at hand:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ColumnConstraints</code> of type <code>ISequence&lt;object&gt;</code>.</p>
</li>
<li>
<p><code>RowConstraints</code> of type <code>ISequence&lt;object&gt;</code>.</p>
</li>
<li>
<p><code>ColumnConstraintsTemplate</code> of type <code>DataTemplate</code>.</p>
</li>
<li>
<p><code>RowConstraintsTemplate</code> of type <code>DataTemplate</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We&#8217;ll experiment with <code>RowConstraints</code> and <code>RowConstraintsTemplate</code>, assuming that the corresponding column properties will exhibit the same behavior.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s start simple and just hardcode a <code>ISequence</code> object.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="diff">    public MainWindow()
    {
        InitializeComponent();

        var puzzle = Puzzle.FromRowStrings(
            "xxxxx",
            "x...x",
            "x...x",
            "x...x",
            "xxxxx"
        );
        var facade = new PiCrossFacade();
        var playablePuzzle = facade.CreatePlayablePuzzle( puzzle );

        playablePuzzle.Grid[new Vector2D( 0, 0 )].Contents.Value = Square.FILLED;
        playablePuzzle.Grid[new Vector2D( 1, 0 )].Contents.Value = Square.EMPTY;

        picrossControl.Grid = playablePuzzle.Grid;
<span class="gi">+       picrossControl.RowConstraints = Sequence.FromItems&lt;object&gt;( 1, 2, 3, 4, 5 );
</span>    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the XAML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="diff">    &lt;controls:PiCrossControl x:Name="picrossControl"&gt;
        &lt;controls:PiCrossControl.SquareTemplate&gt;
            &lt;DataTemplate&gt;
                &lt;Rectangle Width="32" Height="32" Stroke="Black"&gt;
                    &lt;Rectangle.Fill&gt;
                        &lt;Binding Path="Contents.Value"&gt;
                            &lt;Binding.Converter&gt;
                                &lt;local:SquareConverter Empty="White" Filled="Black" Unknown="Gray" /&gt;
                            &lt;/Binding.Converter&gt;
                        &lt;/Binding&gt;
                    &lt;/Rectangle.Fill&gt;
                &lt;/Rectangle&gt;
            &lt;/DataTemplate&gt;
        &lt;/controls:PiCrossControl.SquareTemplate&gt;
<span class="gi">+       &lt;controls:PiCrossControl.RowConstraintsTemplate&gt;
+           &lt;DataTemplate&gt;
+               &lt;TextBlock Width="32" Height="32" Text="{Binding}" /&gt;
+           &lt;/DataTemplate&gt;
+       &lt;/controls:PiCrossControl.RowConstraintsTemplate&gt;
</span>    &lt;/controls:PiCrossControl&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>To the left of the grid, we see the numbers <code>1</code> to <code>5</code> appear, one per row.
The <code>PiCrossControl</code> instantiates the <code>RowConstraintsTemplate</code> once for each row.
However, for our PiCross puzzle, this isn&#8217;t enough: a single row&#8217;s constraints
is not simply one number, it is a series of numbers, e.g. <code>2 3 2</code>. It seems
the <code>PiCrossControl</code> does not take care of this and that we will need to do it ourselves.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s first upgrade our integers to lists of integers:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="diff">    public MainWindow()
    {
        InitializeComponent();

        var puzzle = Puzzle.FromRowStrings(
            "xxxxx",
            "x...x",
            "x...x",
            "x...x",
            "xxxxx"
        );
        var facade = new PiCrossFacade();
        var playablePuzzle = facade.CreatePlayablePuzzle( puzzle );

        playablePuzzle.Grid[new Vector2D( 0, 0 )].Contents.Value = Square.FILLED;
        playablePuzzle.Grid[new Vector2D( 1, 0 )].Contents.Value = Square.EMPTY;

        picrossControl.Grid = playablePuzzle.Grid;
<span class="gd">-       picrossControl.RowConstraints = Sequence.FromItems&lt;object&gt;( 1, 2, 3, 4, 5 );
</span><span class="gi">+       picrossControl.RowConstraints = Sequence.FromItems(
+           new int[] { 1, 2 },
+           new int[] { 4 },
+           new int[] { 1, 1 },
+           new int[] { 1, 1 },
+           new int[] { 1, 1, 1 }
+       );
</span>    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>If we run the application, the numbers <code>1</code> to <code>5</code> are replaced by a rather
unhelpful <code>Int32[]</code>: this is what <code>int[]&#8217;s `ToString()</code> method returns.
To render lists, WPF offers the <code>ItemsControl</code>, which you should already have
encountered earlier.</p>
</div>
<div class="paragraph">
<p>Make the following changes to the XAML code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="diff">    &lt;controls:PiCrossControl x:Name="picrossControl"&gt;
        &lt;controls:PiCrossControl.SquareTemplate&gt;
            &lt;DataTemplate&gt;
                &lt;Rectangle Width="32" Height="32" Stroke="Black"&gt;
                    &lt;Rectangle.Fill&gt;
                        &lt;Binding Path="Contents.Value"&gt;
                            &lt;Binding.Converter&gt;
                                &lt;local:SquareConverter Empty="White" Filled="Black" Unknown="Gray" /&gt;
                            &lt;/Binding.Converter&gt;
                        &lt;/Binding&gt;
                    &lt;/Rectangle.Fill&gt;
                &lt;/Rectangle&gt;
            &lt;/DataTemplate&gt;
        &lt;/controls:PiCrossControl.SquareTemplate&gt;
        &lt;controls:PiCrossControl.RowConstraintsTemplate&gt;
            &lt;DataTemplate&gt;
<span class="gd">-               &lt;TextBlock Width="32" Height="32" Text="{Binding}" /&gt;
</span><span class="gi">+               &lt;ItemsControl ItemsSource="{Binding}"&gt;
+                   &lt;ItemsControl.ItemsPanel&gt;
+                       &lt;ItemsPanelTemplate&gt;
+                           &lt;StackPanel Orientation="Horizontal" /&gt;
+                       &lt;/ItemsPanelTemplate&gt;
+                   &lt;/ItemsControl.ItemsPanel&gt;
+                   &lt;ItemsControl.ItemTemplate&gt;
+                       &lt;DataTemplate&gt;
+                           &lt;TextBlock Width="32" Height="32" Text="{Binding}" /&gt;
+                       &lt;/DataTemplate&gt;
+                   &lt;/ItemsControl.ItemTemplate&gt;
+               &lt;/ItemsControl&gt;
</span>            &lt;/DataTemplate&gt;
        &lt;/controls:PiCrossControl.RowConstraintsTemplate&gt;
    &lt;/controls:PiCrossControl&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Based on this, you should be able to predict what will be shown when you run the application.</p>
</div>
<div class="paragraph">
<p>Let&#8217;s now replace the hardcoded constraints by the puzzle&#8217;s. <code>PlayablePuzzle</code>
has a property <code>RowConstraints</code> of type <code>ISequence&lt;IPlayablePuzzleConstraints&gt;</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="diff">    public MainWindow()
    {
        InitializeComponent();

        var puzzle = Puzzle.FromRowStrings(
            "xxxxx",
            "x...x",
            "x...x",
            "x...x",
            "xxxxx"
        );
        var facade = new PiCrossFacade();
        var playablePuzzle = facade.CreatePlayablePuzzle( puzzle );

        playablePuzzle.Grid[new Vector2D( 0, 0 )].Contents.Value = Square.FILLED;
        playablePuzzle.Grid[new Vector2D( 1, 0 )].Contents.Value = Square.EMPTY;

        picrossControl.Grid = playablePuzzle.Grid;
<span class="gd">-       picrossControl.RowConstraints = Sequence.FromItems(
-           new int[] { 1, 2 },
-           new int[] { 4 },
-           new int[] { 1, 1 },
-           new int[] { 1, 1 },
-           new int[] { 1, 1, 1 }
-       );
</span><span class="gi">+       picrossControl.RowConstraints = playablePuzzle.RowConstraints;
</span>    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>We guess there is one <code>IPlayablePuzzleConstraints</code> per row, so
we expect one <code>IPlayablePuzzleConstraints</code> object to model a list
of integers. Navigate through the code (using F12 to jump straight to a definition always
comes in handy in situations like this) and see how you can match
<code>IPlayablePuzzleConstraints</code> with your expectations.
Update the bindings in the XAML so as to make the right constraints appear:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="text">5
1 1
1 1
1 1
5</code></pre>
</div>
</div>
<div class="paragraph">
<p><strong>Hint</strong> Both bindings will need to be corrected. Start with the <code>ItemsControl&#8217;s `ItemsSource</code> property.
Start by finding out what the <code>ItemsControl&#8217;s `DataContext</code> is. A quick way (a bit hacky) is the
change the binding to <code>{Binding SomeCrap}</code>. If you run the application in debug mode, you&#8217;ll notice
error messages in the output pane. These mention which type the <code>DataContext</code> has.
<code>ItemsControl</code> expects this to be an <code>IEnumerable</code>, but you&#8217;ll find out that isn&#8217;t the case.
You&#8217;ll need to update the binding so as to refer to a specific property
of this object: <code>{Binding SomePropertyOfTheDataContext}</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_future_steps">Future Steps</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Start by making the column constraints work.</p>
</li>
<li>
<p>Next, you&#8217;ll want to make the puzzle interactive. Start simple: make a left mouse click mark the square as filled.</p>
</li>
<li>
<p>Refactor your code so as to comply with MVVM.</p>
</li>
<li>
<p>Add the required functionality as described [here](requirements.md).</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2020-04-11 22:55:09 +0200
</div>
</div>
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge .cm {
  color: #999988;
  font-style: italic;
}
pre.rouge .cp {
  color: #999999;
  font-weight: bold;
}
pre.rouge .c1 {
  color: #999988;
  font-style: italic;
}
pre.rouge .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
pre.rouge .c, pre.rouge .ch, pre.rouge .cd, pre.rouge .cpf {
  color: #999988;
  font-style: italic;
}
pre.rouge .err {
  color: #a61717;
  background-color: #e3d2d2;
}
pre.rouge .gd {
  color: #000000;
  background-color: #ffdddd;
}
pre.rouge .ge {
  color: #000000;
  font-style: italic;
}
pre.rouge .gr {
  color: #aa0000;
}
pre.rouge .gh {
  color: #999999;
}
pre.rouge .gi {
  color: #000000;
  background-color: #ddffdd;
}
pre.rouge .go {
  color: #888888;
}
pre.rouge .gp {
  color: #555555;
}
pre.rouge .gs {
  font-weight: bold;
}
pre.rouge .gu {
  color: #aaaaaa;
}
pre.rouge .gt {
  color: #aa0000;
}
pre.rouge .kc {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kd {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kn {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kp {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kr {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kt {
  color: #445588;
  font-weight: bold;
}
pre.rouge .k, pre.rouge .kv {
  color: #000000;
  font-weight: bold;
}
pre.rouge .mf {
  color: #009999;
}
pre.rouge .mh {
  color: #009999;
}
pre.rouge .il {
  color: #009999;
}
pre.rouge .mi {
  color: #009999;
}
pre.rouge .mo {
  color: #009999;
}
pre.rouge .m, pre.rouge .mb, pre.rouge .mx {
  color: #009999;
}
pre.rouge .sb {
  color: #d14;
}
pre.rouge .sc {
  color: #d14;
}
pre.rouge .sd {
  color: #d14;
}
pre.rouge .s2 {
  color: #d14;
}
pre.rouge .se {
  color: #d14;
}
pre.rouge .sh {
  color: #d14;
}
pre.rouge .si {
  color: #d14;
}
pre.rouge .sx {
  color: #d14;
}
pre.rouge .sr {
  color: #009926;
}
pre.rouge .s1 {
  color: #d14;
}
pre.rouge .ss {
  color: #990073;
}
pre.rouge .s, pre.rouge .sa, pre.rouge .dl {
  color: #d14;
}
pre.rouge .na {
  color: #008080;
}
pre.rouge .bp {
  color: #999999;
}
pre.rouge .nb {
  color: #0086B3;
}
pre.rouge .nc {
  color: #445588;
  font-weight: bold;
}
pre.rouge .no {
  color: #008080;
}
pre.rouge .nd {
  color: #3c5d5d;
  font-weight: bold;
}
pre.rouge .ni {
  color: #800080;
}
pre.rouge .ne {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nf, pre.rouge .fm {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nl {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nn {
  color: #555555;
}
pre.rouge .nt {
  color: #000080;
}
pre.rouge .vc {
  color: #008080;
}
pre.rouge .vg {
  color: #008080;
}
pre.rouge .vi {
  color: #008080;
}
pre.rouge .nv, pre.rouge .vm {
  color: #008080;
}
pre.rouge .ow {
  color: #000000;
  font-weight: bold;
}
pre.rouge .o {
  color: #000000;
  font-weight: bold;
}
pre.rouge .w {
  color: #bbbbbb;
}
pre.rouge {
  background-color: #f8f8f8;
}
</style>
</body>
</html>